{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { API } from '../../../config';\nimport Link from 'next/link';\nimport { showSuccessMessage, showErrorMessage } from '../../../helpers/alerts';\nimport Layout from '../../../components/Layout';\nimport withAdmin from '../../withAdmin';\n\nvar Read = function Read(_ref) {\n  var user = _ref.user,\n      token = _ref.token;\n\n  var _useState = useState({\n    error: '',\n    success: '',\n    categories: []\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var error = state.error,\n      success = state.success,\n      categories = state.categories;\n  useEffect(function () {\n    loadCategories();\n  }, []);\n\n  var loadCategories = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios.get(\"\".concat(API, \"/categories\"));\n\n            case 2:\n              response = _context.sent;\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                categories: response.data\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function loadCategories() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var confirmDelete = function confirmDelete(e, slug) {\n    e.preventDefault(); // console.log('delete > ', slug);\n\n    var answer = window.confirm('Are you sure you want to delete?');\n\n    if (answer) {\n      handleDelete(slug);\n    }\n  };\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(slug) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axios[\"delete\"](\"\".concat(API, \"/category/\").concat(slug), {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 3:\n              response = _context2.sent;\n              console.log('CATEGORY DELETE SUCCESS ', response);\n              loadCategories();\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log('CATEGORY DELETE ', _context2.t0);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n\n    return function handleDelete(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var listCategories = function listCategories() {\n    return categories.map(function (c, i) {\n      return __jsx(Link, {\n        key: i,\n        href: \"/links/\".concat(c.slug)\n      }, __jsx(\"a\", {\n        style: {\n          border: '1px solid red'\n        },\n        className: \"bg-light p-3 col-md-6\"\n      }, __jsx(\"div\", null, __jsx(\"div\", {\n        className: \"row\"\n      }, __jsx(\"div\", {\n        className: \"col-md-3\"\n      }, __jsx(\"img\", {\n        src: c.image && c.image.url,\n        alt: c.name,\n        style: {\n          width: '100px',\n          height: 'auto'\n        },\n        className: \"pr-3\"\n      })), __jsx(\"div\", {\n        className: \"col-md-6\"\n      }, __jsx(\"h3\", null, c.name)), __jsx(\"div\", {\n        className: \"col-md-3\"\n      }, __jsx(Link, {\n        href: \"/admin/category/\".concat(c.slug)\n      }, __jsx(\"button\", {\n        className: \"btn btn-sm btn-outline-success btn-block mb-1\"\n      }, \"Update\")), __jsx(\"button\", {\n        onClick: function onClick(e) {\n          return confirmDelete(e, c.slug);\n        },\n        className: \"btn btn-sm btn-outline-danger btn-block\"\n      }, \"Delete\"))))));\n    });\n  };\n\n  return __jsx(Layout, null, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col\"\n  }, __jsx(\"h1\", null, \"List of categories\"), __jsx(\"br\", null), success && showSuccessMessage(success))), __jsx(\"div\", {\n    className: \"row\"\n  }, listCategories()));\n};\n\nexport default withAdmin(Read);","map":null,"metadata":{},"sourceType":"module"}