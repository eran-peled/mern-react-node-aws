{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport Layout from '../components/Layout';\nimport axios from 'axios';\nimport moment from 'moment';\nimport Link from 'next/link';\nimport { API } from '../config';\n\nvar Home = function Home(_ref) {\n  var categories = _ref.categories;\n\n  var _useState = useState([]),\n      popular = _useState[0],\n      setPopular = _useState[1];\n\n  useEffect(function () {\n    loadPopular();\n  }, []);\n\n  var loadPopular = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios.get(\"\".concat(API, \"/link/popular\"));\n\n            case 2:\n              response = _context.sent;\n              // console.log(response);\n              setPopular(response.data);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function loadPopular() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(linkId) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios.put(\"\".concat(API, \"/click-count\"), {\n                linkId: linkId\n              });\n\n            case 2:\n              response = _context2.sent;\n              loadPopular();\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleClick(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var listOfLinks = function listOfLinks() {\n    return popular.map(function (l, i) {\n      return __jsx(\"div\", {\n        key: i,\n        className: \"row alert alert-secondary p-2\"\n      }, __jsx(\"div\", {\n        className: \"col-md-8\",\n        onClick: function onClick() {\n          return handleClick(l._id);\n        }\n      }, __jsx(\"a\", {\n        href: l.url,\n        target: \"_blank\"\n      }, __jsx(\"h5\", {\n        className: \"pt-2\"\n      }, l.title), __jsx(\"h6\", {\n        className: \"pt-2 text-danger\",\n        style: {\n          fontSize: '12px'\n        }\n      }, l.url))), __jsx(\"div\", {\n        className: \"col-md-4 pt-2\"\n      }, __jsx(\"span\", {\n        className: \"pull-right\"\n      }, moment(l.createdAt).fromNow(), \" by \", l.postedBy.name)), __jsx(\"div\", {\n        className: \"col-md-12\"\n      }, __jsx(\"span\", {\n        className: \"badge text-dark\"\n      }, l.type, \" \", l.medium), l.categories.map(function (c, i) {\n        return __jsx(\"span\", {\n          key: i,\n          className: \"badge text-success\"\n        }, c.name);\n      }), __jsx(\"span\", {\n        className: \"badge text-secondary pull-right\"\n      }, l.clicks, \" clicks\")));\n    });\n  };\n\n  var listCategories = function listCategories() {\n    return categories.map(function (c, i) {\n      return __jsx(Link, {\n        key: i,\n        href: \"/links/\".concat(c.slug)\n      }, __jsx(\"a\", {\n        style: {\n          border: '1px solid red'\n        },\n        className: \"bg-light p-3 col-md-4\"\n      }, __jsx(\"div\", null, __jsx(\"div\", {\n        className: \"row\"\n      }, __jsx(\"div\", {\n        className: \"col-md-4\"\n      }, __jsx(\"img\", {\n        src: c.image && c.image.url,\n        alt: c.name,\n        style: {\n          width: '100px',\n          height: 'auto'\n        },\n        className: \"pr-3\"\n      })), __jsx(\"div\", {\n        className: \"col-md-8\"\n      }, __jsx(\"h3\", null, c.name))))));\n    });\n  };\n\n  return __jsx(Layout, null, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-12\"\n  }, __jsx(\"h1\", {\n    className: \"font-weight-bold\"\n  }, \"Browse Tutorials/Courses\"), __jsx(\"br\", null))), __jsx(\"div\", {\n    className: \"row\"\n  }, listCategories()), __jsx(\"div\", {\n    className: \"row pt-5\"\n  }, __jsx(\"h2\", {\n    className: \"font-weight-bold pb-3\"\n  }, \"Trending \", popular.length), __jsx(\"div\", {\n    className: \"col-md-12 overflow-hidden\"\n  }, listOfLinks())));\n};\n\nHome.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n  var response;\n  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return axios.get(\"\".concat(API, \"/categories\"));\n\n        case 2:\n          response = _context3.sent;\n          return _context3.abrupt(\"return\", {\n            categories: response.data\n          });\n\n        case 4:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _callee3);\n}));\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}